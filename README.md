# Пример voice-2-voice взаимодействия с RT API

## Пререквизиты
Для работы нужно получить id каталога и апи-ключи.
Для этого выполните шаги из [инструкции](https://github.com/anakarimova/setup_cloud_repo/blob/main/README.md)

## 🚀 Быстрый старт

1. Склонируйте или скачайте проект.
2. Перейдите в папку проекта.
3. Установите Python-зависимости:
   ```bash
   make install
   ```
4. Установите ffmpeg (поддерживается macOS/Homebrew и Ubuntu):
   ```bash
   make install-ffmpeg
   ```
5. Укажите свои значения:
   - **Folder ID** и **API-ключ** — пропишите их в `main.py` или передайте через переменные окружения.
   - **Аудиофайл** — укажите путь к входному аудио (с вашей репликой).
6. Запустите приложение:
   ```bash
   make run
   ```

---

## 📊 Схема взаимодействия

```text
┌──────────────────────┐
│      main.py         │
└─────────┬────────────┘
          │
          │ 1. Конвертация входного аудио → 24kHz PCM16 (ffmpeg)
          ▼
┌──────────────────────┐
│ converted.wav готов  │
└─────────┬────────────┘
          │
          │ 2. Устанавливаем WebSocket-соединение
          │    с Realtime API (wss://...)
          ▼
┌───────────────────────────┐
│   Yandex Cloud Realtime   │
│          API              │
└──────────┬────────────────┘
           │
           │ 3. Получаем событие session.created
           │ 4. Отправляем session.update:
           │    • включаем server_vad  
           │    • указываем голос (marina)  
           │    • настраиваем text+audio вывод
           │    • задаём инструкцию для модели
           │
           │ 5. Отправляем аудио чанками (input_audio_buffer.append)
           │    + 500мс тишины для срабатывания VAD
           │
           │ 6. Сообщаем commit (input_audio_buffer.commit)
           │
           │ 7. Ждём ответ от модели:
           │    • response.output_text.delta  → собираем текст
           │    • response.output_audio.delta → собираем аудио
           │
           │ 8. Когда response.done → сохраняем результат:
           │    • печатаем текст в stdout
           │    • сохраняем озвучку в output.wav
           ▼
┌───────────────────────────────┐
│  Готовый ответ + аудио файл   │
│   (можно проиграть клиенту)   │
└───────────────────────────────┘
```

## 🧪 Поле для экспериментов

1. Попробуйте заменить входной аудиофайл  
   (например, сгенерируйте его в [консоли SpeechKit](https://console.yandex.cloud/link/speechkit)).
2. Попробуйте изменить системную инструкцию в коде.
3. Попробуйте сменить голос для озвучки ответа.


---
